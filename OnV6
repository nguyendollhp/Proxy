#!/bin/bash

# Lấy địa chỉ IPv6 đầu tiên có scope global
ipv6=$(ip -6 addr show scope global | grep inet6 | awk '{print $2}' | cut -d/ -f1 | head -n 1)

# Nếu không có IPv6 thì thoát
if [ -z "$ipv6" ]; then
    echo "Không tìm thấy địa chỉ IPv6 nào (scope global)."
    exit 1
fi

# Tự động tìm tên interface (ví dụ: ens3, eth0...)
interface=$(ip -6 addr show scope global | grep -B1 "$ipv6" | head -n1 | awk -F: '{print $2}' | tr -d ' ')

echo "Đang cấu hình IPv6: $ipv6 trên interface: $interface"

# Thêm địa chỉ IPv6 vào interface
ip addr add $ipv6/64 dev $interface

# (Tuỳ chọn) Thêm default route nếu cần (nếu bạn biết cổng gateway)
# ip -6 route add default via <GATEWAY> dev $interface

echo "✅ Cấu hình IPv6 hoàn tất."
